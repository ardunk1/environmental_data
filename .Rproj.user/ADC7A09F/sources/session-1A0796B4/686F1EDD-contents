---  
title: "Exercise #20"
author: "Adrienne Dunk"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
---  

<!-- These are global options  
       set root directory here 
       NOTE mine is active; yours is commented out
       change the path to reflect your PC,
       then comment out or delete mine 
--> 

---

## Select An Appropriate Path for Your PC

Several examples are shown below

```{r global_options, include=T}
# recommended baseR directory location for you
  knitr::opts_knit$set(root.dir = "~/baseR-V2022.2") 

# turn off annoying messages with this option
  knitr::opts_chunk$set(warning = T, error = T, message = F)
```

---

## Where to Submit Your Homework

Submit the completed exercise to:

* t.edwards@usu.edu 

---

## Please Indicate How Many Hours You Worked on the Exercise

Indicate hours as HH.QuarterHH, eg.:

1 hr 30 min

---

## Objectives

Create a histogram to meet a journal editor's requests regarding formatting.


### Element 20.1
Import the data and examine its characteristics.

```{r}
setwd("C:/Users/adrienne.dunk/Documents/baseR-V2022.2/data/exercise_dat/")
library(magrittr)

z1 <- read.csv("zapusmorph.csv", na.strings = ".", header = T)
z2 <- z1 %>% dplyr::filter(SPP == 1) %>% dplyr::select(SPP, SEX, IFWID)
```

---

### Element 20.2
Re-produce histogram from Mod 5.6 BUT: 
* remove extra white space that results from graph stacking, 
* add common y-axis label
* make Male and Female labels legends within each graph using two different colors from orange range, 
* include x-axis tick marks on both graphs, but only the label bottom graph
* remove additional white space from between the two graphs

Set up graphing limits:
```{r}

#establish x-axis range
xlim_rang <- range(z2 %$% min(IFWID) %>% round(1), 
                   z2 %$% max(IFWID) %>% round(1))

#establish y-axis range
max_male <- z2 %>% dplyr::filter(SEX == "M") %$% cut(IFWID, 9) %>% table() %>% max()
#take the male values, divide them into 10 bins (cut 9 times), use table to count
#the number that fall into each bin, then return the maximum number for any given bin
max_male #3

max_female <- z2 %>% dplyr::filter(SEX == "F") %$% cut(IFWID, 9) %>% table() %>% max()
max_female #4

ylim_rang <- range(0, max_male, max_female) # select higher or male or female max
ylim_rang #range of 0-4 for y axis
```

Create the graph:
```{r}
#create graphs

par(mfrow = c(2,1), mar = c(1.1, 4.1, 1.1, 1.1), oma = c(0, 2, 0, 0))
z2 %>% dplyr::filter(SEX == "M") %$%
  hist(IFWID, xlim = xlim_rang, ylim = ylim_rang, 
       breaks = 9, xlab = NULL, ylab = NULL, main = NULL, xaxt = "n", col = "orange")
legend("topleft", "Male", bty = "n")
axis(side = 1, at = c(1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3), labels = c("", "", "", "", "", "", ""))


par(mar = c(4.1, 4.1, 1.1, 1.1))
z2 %>% dplyr::filter(SEX == "F") %$% 
  hist(IFWID, xlab = "IFWID length(mm)", ylab = NULL, xlim = xlim_rang, 
       ylim = ylim_rang, breaks = 9, main = NULL,col = "darkorange4")
legend("topleft", "Female", bty = "n")
mtext("Frequency", outer = T, side = 2)


```

### Element 20.3
Create a table of the raw data
```{r}
library(knitr)
library(kableExtra)


kable(z2, "html", align = c("l", "c", "c"),
      col.names = c("SPP", "SEX", "IFWID"), 
      caption = "Raw Data Used to Create Figure in Element 20.2") %>% kable_styling(bootstrap_options = c("hover", "condensed"), full_width = F)

```


---

## das Ende

---